"use strict";(self.webpackChunklago_doc=self.webpackChunklago_doc||[]).push([[8187],{3905:(e,t,r)=>{r.d(t,{Zo:()=>g,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},g=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),u=s(r),m=a,c=u["".concat(p,".").concat(m)]||u[m]||d[m]||i;return r?n.createElement(c,o(o({ref:t},g),{},{components:r})):n.createElement(c,o({ref:t},g))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=r[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},3612:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=r(7462),a=(r(7294),r(3905));const i={sidebar_position:2},o="Aggregation Types",l={unversionedId:"guide/billable-metrics/aggregation-types",id:"guide/billable-metrics/aggregation-types",title:"Aggregation Types",description:"Metered aggregation types",source:"@site/docs/guide/04_billable-metrics/aggregation-types.md",sourceDirName:"guide/04_billable-metrics",slug:"/guide/billable-metrics/aggregation-types",permalink:"/docs/guide/billable-metrics/aggregation-types",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"guide",previous:{title:"Overview",permalink:"/docs/guide/billable-metrics/overview"},next:{title:"Aggregation examples",permalink:"/docs/guide/billable-metrics/aggregation-examples"}},p={},s=[{value:"Metered aggregation types",id:"metered-aggregation-types",level:2},{value:"Persistent aggregation types",id:"persistent-aggregation-types",level:2}],g={toc:s};function d(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,n.Z)({},g,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"aggregation-types"},"Aggregation Types"),(0,a.kt)("h2",{id:"metered-aggregation-types"},"Metered aggregation types"),(0,a.kt)("p",null,"By selecting a ",(0,a.kt)("strong",{parentName:"p"},"metered")," aggregation type for a billable metric, the calculated units to be charged are resumed to 0 at the end of each billing period. These aggregation types, listed below, define how the ingested events are compiled and calculated at the end of a billable period."),(0,a.kt)("p",null,"Here is the full list of ",(0,a.kt)("strong",{parentName:"p"},"metered aggregation types")," currently supported officially by Lago."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Aggregation"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"),(0,a.kt)("th",{parentName:"tr",align:null},"Transcription"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"COUNT")),(0,a.kt)("td",{parentName:"tr",align:null},"Count the number of times an incoming event occurs"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"COUNT(event.code)"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"SUM")),(0,a.kt)("td",{parentName:"tr",align:null},"Sum a defined property for incoming events"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"SUM(event.properties.property_name)"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"MAX")),(0,a.kt)("td",{parentName:"tr",align:null},"Get the maximum value of a defined property for incoming events"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"MAX(event.properties.property_name)"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"COUNT UNIQUE")),(0,a.kt)("td",{parentName:"tr",align:null},"Count the number of unique value of a defined property for incoming events"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"COUNT_DISTINCT(event.properties.property_name)"))))),(0,a.kt)("p",null,"Except the ",(0,a.kt)("inlineCode",{parentName:"p"},"COUNT"),"(that is counting the number of times an event occurs), the other types aggregate over a single property of the event. ",(0,a.kt)("strong",{parentName:"p"},"The result of this aggregation will be used to charge your customers.")),(0,a.kt)("h2",{id:"persistent-aggregation-types"},"Persistent aggregation types"),(0,a.kt)("p",null,"By selecting a ",(0,a.kt)("strong",{parentName:"p"},"persistent aggregation type")," for a billable metric, the calculated units to be charged are persisted periods over periods, unless you or your customers decide to change it. This is very useful if you want to build a fair pricing model (ie: per-seat, or per-integration pricing for instance)."),(0,a.kt)("p",null,"Here is the full list of ",(0,a.kt)("strong",{parentName:"p"},"persistent aggregation types")," currently supported officially by Lago."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Aggregation"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"),(0,a.kt)("th",{parentName:"tr",align:null},"Transcription"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"RECURRING COUNT")),(0,a.kt)("td",{parentName:"tr",align:null},"Count the number of unique value of a defined property for incoming events, ",(0,a.kt)("strong",{parentName:"td"},"but persists the value period over period unless you change it")),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ADD(event.properties.property_name)")," or  ",(0,a.kt)("inlineCode",{parentName:"td"},"REMOVE(event.properties.property_name)"))))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Add"),": this ",(0,a.kt)("inlineCode",{parentName:"li"},"operation_type")," adds that item to the units to be charged at the end of the period. You don't need to send the event every billing period to charge your customers. The charge for this item is pro-rated for the first period."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Remove"),": this ",(0,a.kt)("inlineCode",{parentName:"li"},"operation_type")," removes that item to the units to be charged at the end of the period. It will not be taken into account for the next billing periods. The charge for this item is pro-rated for the last period.")),(0,a.kt)("p",null,"On the image below, let's take back the example of a fair per-seats pricing.\n",(0,a.kt)("img",{alt:"Persistent Billable Metric",src:r(3695).Z,width:"1576",height:"912"})),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"p"},"Lago automatically created a pro-rated charge based on the number of days consumed by an item during a billing period.")," An item that is added is persisted and charged period over period.")))}d.isMDXComponent=!0},3695:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/persistent-billable-metric-ffebe34342326e75822cf8918db05f22.png"}}]);