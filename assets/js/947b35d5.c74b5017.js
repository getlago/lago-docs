"use strict";(self.webpackChunklago_doc=self.webpackChunklago_doc||[]).push([[6533],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>g});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var c=n.createContext({}),s=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(a),m=i,g=u["".concat(c,".").concat(m)]||u[m]||p[m]||o;return a?n.createElement(g,r(r({ref:t},d),{},{components:a})):n.createElement(g,r({ref:t},d))}));function g(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:i,r[1]=l;for(var s=2;s<o;s++)r[s]=a[s];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},32932:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var n=a(87462),i=(a(67294),a(3905));const o={sidebar_position:2},r="Tracking & Analytics",l={unversionedId:"guide/self-hosting/tracking",id:"guide/self-hosting/tracking",title:"Tracking & Analytics",description:"Why does Lago need data?",source:"@site/docs/guide/02_self-hosting/tracking.md",sourceDirName:"guide/02_self-hosting",slug:"/guide/self-hosting/tracking",permalink:"/docs/guide/self-hosting/tracking",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"guide",previous:{title:"Docker",permalink:"/docs/guide/self-hosting/docker"},next:{title:"Lago Cloud",permalink:"/docs/guide/lago-cloud"}},c={},s=[{value:"Why does Lago need data?",id:"why-does-lago-need-data",level:2},{value:"Opting out",id:"opting-out",level:2},{value:"Detail of events collected by Lago",id:"detail-of-events-collected-by-lago",level:2},{value:"Detail of data collected about your organization",id:"detail-of-data-collected-about-your-organization",level:2},{value:"Examples of collected payloads",id:"examples-of-collected-payloads",level:2},{value:"billable_metric_created",id:"billable_metric_created",level:3},{value:"customer_created",id:"customer_created",level:3},{value:"invoice_created",id:"invoice_created",level:3}],d={toc:s},u="wrapper";function p(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"tracking--analytics"},"Tracking & Analytics"),(0,i.kt)("h2",{id:"why-does-lago-need-data"},"Why does Lago need data?"),(0,i.kt)("p",null,"We decided to open-source the billing API we would have dreamt to use. As a consequence of building a self hosted product, we are not able to easily collect any usage metrics or insights to help us build a better product. This analytic help us understand crucial behaviors and ship better quality to serve your needs."),(0,i.kt)("p",null,"We decided to track, by default, so basic behaviors and metrics that are important to understand the usage of Lago. We have built a minimum required tracking plan to minimize the security impact of collecting those events. All the metrics collected are listed in a further section. We make this as transparent as possible, and we don't track financial information (amounts of invoices, for instance)."),(0,i.kt)("p",null,"The metrics are collected through the server side Ruby source from ",(0,i.kt)("a",{parentName:"p",href:"https://segment.com/docs/connections/sources/catalog/libraries/server/ruby/"},"Segment.com"),"."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Lago will not collect any financial information about your customers or your invoices.")),(0,i.kt)("h2",{id:"opting-out"},"Opting out"),(0,i.kt)("p",null,"As detailed previously, we ask you to keep as much as possible those tracked metrics, unless you have a specific reason to opt out. Keeping the metrics enabled is the easiest way for Lago to get feedback based on product usage."),(0,i.kt)("p",null,"In the case you need to remove it, we've created a very easy process to opt out. In the environment variables, by passing the field ",(0,i.kt)("inlineCode",{parentName:"p"},"LAGO_DISABLE_SEGMENT")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", you prevent the entire tracking logic to run in your application."),(0,i.kt)("h2",{id:"detail-of-events-collected-by-lago"},"Detail of events collected by Lago"),(0,i.kt)("p",null,"This event flow enables Lago to understand the full activation flow, from the registration to the first invoice generated."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"organization_registered"),": when you create your organization by signing up to Lago"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"billable_metric_created"),": whenever you create a new billable metric"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"plan_created"),": whenever you create a new plan"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"customer_created"),": whenever a customer is created in Lago"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"subscription_created"),": when a subscription is assigned to a customer"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"coupon_created"),": whenever a new coupon is created"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"applied_coupon_created"),": when a coupon is assigned to a customer"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"add_on_created"),": whenever a new add-on is created"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"applied_add_on_created"),": when an add-on is assigned to a customer"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"invoice_created"),": when a new invoice is emitted for a specific customer"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"payment_status_changed"),": when the payment status of an invoice changes"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"credit_note_issued"),": when a new credit note is issued for a customer"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"billable_metric_deleted"),": when a billable metric is deleted"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"plan_deleted"),": when a plan is deleted"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"customer_deleted"),": when a customer account is deleted")),(0,i.kt)("h2",{id:"detail-of-data-collected-about-your-organization"},"Detail of data collected about your organization"),(0,i.kt)("p",null,"By default, we collect data of your organization that you used in the signup form:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Your organization's ",(0,i.kt)("strong",{parentName:"li"},"email"),"; and"),(0,i.kt)("li",{parentName:"ul"},"Your organization's ",(0,i.kt)("strong",{parentName:"li"},"name"),".")),(0,i.kt)("p",null,"By ",(0,i.kt)("a",{parentName:"p",href:"./tracking#opting-out"},"opting out"),", your organization's data won't be tracked anymore."),(0,i.kt)("h2",{id:"examples-of-collected-payloads"},"Examples of collected payloads"),(0,i.kt)("h3",{id:"billable_metric_created"},"billable_metric_created"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"Analytics.track(\n  user_id: 'membership/f37a6b2e-1e79-4710-b0e2-9e451b532461',\n  event: 'billable_metric_created',\n  properties: {\n    aggregation_property: 'amount',\n    aggregation_type: 'sum_agg',\n    code: 'atm',\n    description: '',\n    hosting_type: 'self',\n    name: 'ATM',\n    organization_id: '7c868af7-201c-4ebc-9829-ca902e289e5f',\n    version: DateTime.iso8601('2022-07-27T00:00:00.000Z')\n  }\n)\n")),(0,i.kt)("h3",{id:"customer_created"},"customer_created"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"Analytics.track(\n  user_id: 'membership/4ad5b91f-2a42-4a58-9786-6c07fa03a3d4',\n  event: 'customer_created',\n  properties: {\n    created_at: DateTime.iso8601('2022-08-10T09:34:37.479Z'),\n    customer_id: '29a17eed-021c-485e-b3fa-93d27db31c95',\n    hosting_type: 'cloud',\n    organization_id: '0d173830-9017-4f57-9d11-e3e83b3e38fe',\n    payment_provider: 'stripe',\n    version: DateTime.iso8601('2022-08-09T00:00:00.000Z')\n  }\n)\n")),(0,i.kt)("h3",{id:"invoice_created"},"invoice_created"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"Analytics.track(\n  user_id: 'membership/f37a6b2e-1e79-4710-b0e2-9e451b532461',\n  event: 'invoice_created',\n  properties: {\n    hosting_type: 'cloud',\n    invoice_id: '0e31afd2-8e15-49e1-a6fb-11895fa03c97',\n    invoice_type: 'subscription',\n    organization_id: 'b3e35674-c3d1-4279-8ef1-271271b6cafb',\n    version: DateTime.iso8601('2022-07-27T00:00:00.000Z')\n  }\n)\n")))}p.isMDXComponent=!0}}]);