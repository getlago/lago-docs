"use strict";(self.webpackChunklago_doc=self.webpackChunklago_doc||[]).push([[1577],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(n),m=i,h=c["".concat(s,".").concat(m)]||c[m]||d[m]||r;return n?a.createElement(h,l(l({ref:t},u),{},{components:n})):a.createElement(h,l({ref:t},u))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},76612:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(87462),i=(n(67294),n(3905));const r={sidebar_position:5},l="Subscriptions",o={unversionedId:"guide/plans/subscription",id:"guide/plans/subscription",title:"Subscriptions",description:"A subscription is created when a plan is assigned to a customer. You can assign a plan to a customer at any time (i.e. when the customer record is created or later on).",source:"@site/docs/guide/05_plans/subscription.md",sourceDirName:"guide/05_plans",slug:"/guide/plans/subscription",permalink:"/docs/guide/plans/subscription",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"guide",previous:{title:"Invoiceable",permalink:"/docs/guide/plans/charges/invoiceable"},next:{title:"Upgrades & Downgrades",permalink:"/docs/guide/plans/upgrades-downgrades"}},s={},p=[{value:"Billing cycles",id:"billing-cycles",level:2},{value:"Calendar billing period",id:"calendar-billing-period",level:3},{value:"Anniversary billing period",id:"anniversary-billing-period",level:3},{value:"Subscription date",id:"subscription-date",level:2},{value:"Start date in the past",id:"start-date-in-the-past",level:3},{value:"Start date in the future",id:"start-date-in-the-future",level:3},{value:"Multiple plans",id:"multiple-plans",level:2},{value:"Overwriting a plan",id:"overwriting-a-plan",level:2},{value:"Deleting a plan",id:"deleting-a-plan",level:2}],u={toc:p},c="wrapper";function d(e){let{components:t,...r}=e;return(0,i.kt)(c,(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"subscriptions"},"Subscriptions"),(0,i.kt)("p",null,"A ",(0,i.kt)("a",{parentName:"p",href:"../../api/subscriptions/subscription-object"},"subscription")," is created when a plan is assigned to a customer. You can assign a plan to a customer at any time (i.e. when the customer record is created or later on)."),(0,i.kt)("p",null,"To assign a plan to a customer through the user interface:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Access the ",(0,i.kt)("strong",{parentName:"li"},'"Customers"')," section via the side menu;"),(0,i.kt)("li",{parentName:"ol"},"Select a customer from the list;"),(0,i.kt)("li",{parentName:"ol"},"In the ",(0,i.kt)("strong",{parentName:"li"},'"Overview"')," tab, click ",(0,i.kt)("strong",{parentName:"li"},'"Add a plan"')," on the right;"),(0,i.kt)("li",{parentName:"ol"},"Select a plan (that you can overwrite if needed - ",(0,i.kt)("a",{parentName:"li",href:"#overwriting-a-plan"},"see below"),");"),(0,i.kt)("li",{parentName:"ol"},"Give a name to the subscription (name that will be displayed on the invoice - optional);"),(0,i.kt)("li",{parentName:"ol"},"Set a subscription date (start date of the subscription - ",(0,i.kt)("a",{parentName:"li",href:"#subscription-date"},"see below"),")"),(0,i.kt)("li",{parentName:"ol"},"Choose whether the subscription should be renewed at the beginning of the period or on its anniversary date (see ",(0,i.kt)("a",{parentName:"li",href:"subscription#billing-cycles"},"below"),"); and"),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},'"Add plan"')," to confirm.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The subscription date displayed in the app is based on the organization's timezone.")),(0,i.kt)("p",null,"When a subscription is active, Lago will automatically generate invoices for the customer according to the ",(0,i.kt)("a",{parentName:"p",href:"./plan-model"},"plan model"),". It will also start monitoring the customer's consumption, which means that you can start pushing ",(0,i.kt)("a",{parentName:"p",href:"../../api/events/metered-event"},"events")," related to this subscription."),(0,i.kt)("h2",{id:"billing-cycles"},"Billing cycles"),(0,i.kt)("h3",{id:"calendar-billing-period"},"Calendar billing period"),(0,i.kt)("p",null,"By default, subscriptions are based on ",(0,i.kt)("strong",{parentName:"p"},"calendar periods"),". Therefore, if you assign a monthly plan to a customer on July 14th:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The first invoice will be generated for the period July 14th to July 31st;"),(0,i.kt)("li",{parentName:"ul"},"The next invoice will be generated for the period August 1st to August 31st; and"),(0,i.kt)("li",{parentName:"ul"},"All future invoices will be generated for full calendar months.")),(0,i.kt)("p",null,"When a subscription starts during the month, the subscription fee will be calculated on a ",(0,i.kt)("strong",{parentName:"p"},"pro rata basis")," according to the number of days."),(0,i.kt)("p",null,"Consider the following example:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Your customer signs up for the Premium plan ($50 monthly) on August 10th."),(0,i.kt)("p",{parentName:"blockquote"},"There are 22 days left until the end of the month (including August 10th). Therefore, the subscription fee for August is:"),(0,i.kt)("p",{parentName:"blockquote"},"22 days x $50 / 31 days = $35.48")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Illustration of the anniversary date logic",src:n(40389).Z,width:"2628",height:"544"})),(0,i.kt)("h3",{id:"anniversary-billing-period"},"Anniversary billing period"),(0,i.kt)("p",null,"Another option is to use the ",(0,i.kt)("strong",{parentName:"p"},"anniversary date")," of the subscription to define a custom billing period."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Your customer signs up for the Premium plan on August 10th."),(0,i.kt)("p",{parentName:"blockquote"},"If you choose to align the billing cycle with the anniversary date of the subscription, the customer will be billed every 10th of the month."),(0,i.kt)("p",{parentName:"blockquote"},"The first billing period will run from August 10th to September 9th.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Illustration of the anniversary date logic",src:n(46443).Z,width:"2828",height:"636"})),(0,i.kt)("h2",{id:"subscription-date"},"Subscription date"),(0,i.kt)("p",null,"By default, the subscription starts the day it is created. However, you can set a subscription date in the past or in the future. The subscription date displayed in the app is based on the ",(0,i.kt)("a",{parentName:"p",href:"../../../changelog/timezones"},"organization's timezone"),"."),(0,i.kt)("h3",{id:"start-date-in-the-past"},"Start date in the past"),(0,i.kt)("p",null,"If the start date of the subscription is in the past, the subscription is considered active."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Lago will not generate any invoices for past periods already completed.")),(0,i.kt)("p",null,"The invoicing process varies depending on the ",(0,i.kt)("a",{parentName:"p",href:"/docs/guide/plans/plan-model"},"plan model")," and ",(0,i.kt)("a",{parentName:"p",href:"#billing-cycles"},"billing cycle"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If the plan includes a subscription fee to be paid in advance, it will be considered as ",(0,i.kt)("strong",{parentName:"li"},"already paid for the current period"),". The next invoice will include the usage-based charges for the current period and the subscription fee for the next period (see example 1 below); and"),(0,i.kt)("li",{parentName:"ul"},"If the plan includes a subscription fee to be paid in arrears, it will be ",(0,i.kt)("strong",{parentName:"li"},"included in the next invoice"),", together with the usage-based charges for the current period (see example 2 below).")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example 1:")," Start date in the past and subscription fee to be paid in advance\n",(0,i.kt)("img",{alt:"Illustration for start date in the past and subscription fee in advance",src:n(29597).Z,width:"2376",height:"646"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example 2:")," Start date in the past and subscription fee to be paid in arrears\n",(0,i.kt)("img",{alt:"Illustration for start date in the past and subscription fee in advance",src:n(12292).Z,width:"2376",height:"646"})),(0,i.kt)("h3",{id:"start-date-in-the-future"},"Start date in the future"),(0,i.kt)("p",null,"If the start date of the subscription is in the future, the subscription is considered pending."),(0,i.kt)("p",null,"The invoicing process varies depending on the ",(0,i.kt)("a",{parentName:"p",href:"/docs/guide/plans/plan-model"},"plan model")," and ",(0,i.kt)("a",{parentName:"p",href:"#billing-cycles"},"billing cycle"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If the plan includes a subscription fee to be paid in advance, when the subscription becomes active, Lago will automatically generate an ",(0,i.kt)("strong",{parentName:"li"},"invoice for the subscription fee"),". Usage-based charges will be included in the next invoice, generated at the end of the billing period (see example 3 below); and"),(0,i.kt)("li",{parentName:"ul"},"If the plan includes a subscription fee to be paid in arrears, when the subscription becomes active, ",(0,i.kt)("strong",{parentName:"li"},"there will be no invoice"),". The subscription fee and usage-based charges will be included in the invoice generated at the end of the billing period (see example 4 below).")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example 3:")," Start date in the future and subscription fee to be paid in advance\n",(0,i.kt)("img",{alt:"Illustration for start date in the future and subscription fee in advance",src:n(21237).Z,width:"2376",height:"550"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example 4:")," Start date in the future and subscription fee to be paid in arrears\n",(0,i.kt)("img",{alt:"Illustration for start date in the future and subscription fee in arrears",src:n(57189).Z,width:"1188",height:"275"})),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"It is possible to update the start date of a pending subscription via the user interface (click the ",(0,i.kt)("strong",{parentName:"p"},"ellipsis icon"),", then ",(0,i.kt)("strong",{parentName:"p"},'"Edit subscription"'),") or ",(0,i.kt)("a",{parentName:"p",href:"../../api/subscriptions/update-subscription"},"via the API"),".")),(0,i.kt)("h2",{id:"multiple-plans"},"Multiple plans"),(0,i.kt)("p",null,"You may create several subscriptions for a customer by assigning them multiple plans. This can be particularly useful if your application allows customers to create different projects or workspaces (e.g. Free plan for Workspace 1, Free plan for Workspace 2, Premium plan for Workspace 3, etc.)."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"There are some rules to keep in mind when assigning multiple plans to a customer:"),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"All plans must be denominated in the same currency; and"),(0,i.kt)("li",{parentName:"ol"},"You must specify the ",(0,i.kt)("inlineCode",{parentName:"li"},"external_subscription_id")," for each event or create ",(0,i.kt)("a",{parentName:"li",href:"../../api/events/create-batch-event"},"batch events"),"."))),(0,i.kt)("p",null,"We recommend that you give each subscription a name when assigning multiple plans to a customer. The subscription names will make it easier to differentiate each plan and will also be displayed on the invoices."),(0,i.kt)("p",null,"When multiple subscriptions are linked to a customer, Lago will automatically consolidate invoices when possible."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Month 1"),(0,i.kt)("th",{parentName:"tr",align:null},"Month 2"),(0,i.kt)("th",{parentName:"tr",align:null},"Month 3"),(0,i.kt)("th",{parentName:"tr",align:null},"Month 4"),(0,i.kt)("th",{parentName:"tr",align:null},"(...)"),(0,i.kt)("th",{parentName:"tr",align:null},"Month 13"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Plan A (monthly)"),(0,i.kt)("td",{parentName:"tr",align:null},"$40"),(0,i.kt)("td",{parentName:"tr",align:null},"$40"),(0,i.kt)("td",{parentName:"tr",align:null},"$40"),(0,i.kt)("td",{parentName:"tr",align:null},"$40"),(0,i.kt)("td",{parentName:"tr",align:null},"(...)"),(0,i.kt)("td",{parentName:"tr",align:null},"$40")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Plan B (monthly)"),(0,i.kt)("td",{parentName:"tr",align:null},"$60"),(0,i.kt)("td",{parentName:"tr",align:null},"$60"),(0,i.kt)("td",{parentName:"tr",align:null},"$60"),(0,i.kt)("td",{parentName:"tr",align:null},"$60"),(0,i.kt)("td",{parentName:"tr",align:null},"(...)"),(0,i.kt)("td",{parentName:"tr",align:null},"$60")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Plan C (yearly)"),(0,i.kt)("td",{parentName:"tr",align:null},"$500"),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"(...)"),(0,i.kt)("td",{parentName:"tr",align:null},"$500")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Total invoice"),(0,i.kt)("td",{parentName:"tr",align:null},"$600"),(0,i.kt)("td",{parentName:"tr",align:null},"$100"),(0,i.kt)("td",{parentName:"tr",align:null},"$100"),(0,i.kt)("td",{parentName:"tr",align:null},"$100"),(0,i.kt)("td",{parentName:"tr",align:null},"(...)"),(0,i.kt)("td",{parentName:"tr",align:null},"$600")))),(0,i.kt)("p",null,"It is possible to link to the same customer subscriptions that are based on different billing cycles (e.g. a subscription based on calendar dates and another based on the anniversary date)."),(0,i.kt)("h2",{id:"overwriting-a-plan"},"Overwriting a plan"),(0,i.kt)("p",null,"You can use an existing plan as a template to create a new plan for your customer."),(0,i.kt)("p",null,"When assigning a plan to a customer via the user interface:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Select an existing plan;"),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},'"Overwrite"'),", next to the plan name;"),(0,i.kt)("li",{parentName:"ol"},"Choose a name and a code for the new plan;"),(0,i.kt)("li",{parentName:"ol"},"Modify the plan model and charges according to your needs; and"),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},'"Duplicate plan"')," to confirm.")),(0,i.kt)("p",null,"To start a subscription, the currency of the new plan must match the currency associated with the customer."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Overwriting a plan has no impact on the original plan or existing subscriptions.")),(0,i.kt)("h2",{id:"deleting-a-plan"},"Deleting a plan"),(0,i.kt)("p",null,"You may ",(0,i.kt)("a",{parentName:"p",href:"../../api/plans/destroy-plan"},"delete a plan")," linked to existing subscriptions."),(0,i.kt)("p",null,"If you do so, the subscriptions associated with this plan will be immediately terminated. This action may trigger the generation of invoices and/or credit notes."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"After deleting a plan, you can create a new one using the same code.")))}d.isMDXComponent=!0},46443:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/anniversary-date-c66bee86224946e6e00af9c0cb7eedeb.png"},40389:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/calendar-date-227bf60245e9d3715d3383098c88c1b0.png"},21237:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/subscription-future-advance-e0c8d632579fe11dfc530987d86ca211.png"},57189:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/subscription-future-arrears-8b99c7c98e2f8223d6282fd5f47a665a.png"},29597:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/subscription-past-advance-0bedeeb9f9918608568ea7db6479e4ef.png"},12292:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/subscription-past-arrears-b4f22483b4ae3a358c0b27305e49a766.png"}}]);