<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guide/stripe-integration">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="Lago documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="Lago documentation Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Lago documentation" href="/opensearch.xml"><title data-rh="true">Stripe Integration | Lago documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://getlago.com//docs/guide/stripe-integration"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Stripe Integration | Lago documentation"><meta data-rh="true" name="description" content="Lago&#x27;s native integration with Stripe allows you to collect payments automatically when new invoices are generated."><meta data-rh="true" property="og:description" content="Lago&#x27;s native integration with Stripe allows you to collect payments automatically when new invoices are generated."><link data-rh="true" rel="icon" href="/img/lago.ico"><link data-rh="true" rel="canonical" href="https://getlago.com//docs/guide/stripe-integration"><link data-rh="true" rel="alternate" href="https://getlago.com//docs/guide/stripe-integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://getlago.com//docs/guide/stripe-integration" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://PGTV8J052Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c783990f.css">
<link rel="preload" href="/assets/js/runtime~main.395518a5.js" as="script">
<link rel="preload" href="/assets/js/main.22c07d6a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/docs/guide/intro"><div class="navbar__logo"><img src="/img/logo.svg" alt="Lago" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Lago" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Lago</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/guide/intro">Guide</a><a class="navbar__item navbar__link" href="/docs/api/intro">API Reference</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/changelog">Changelog</a><a href="https://github.com/getlago/lago" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://calendly.com/lago-team/20min-meeting-with-lago-team" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Book a demo</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/intro">Welcome to Lago</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide/self-hosting/docker">Lago Self Hosted</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/lago-cloud">Lago Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide/billable-metrics/overview">Billable Metrics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide/plans/overview">Plans</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/customers">Customers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/coupons">Coupons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/addons">Add-ons</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide/events/ingesting_events">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide/invoicing/overview">Invoicing</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guide/testing-integration">Integration Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/guide/stripe-integration">Stripe Integration</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Stripe Integration</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Stripe Integration</h1><p>Lago&#x27;s native integration with Stripe allows you to collect payments automatically when new invoices are generated.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="setting-up-the-integration">Setting up the integration<a class="hash-link" href="#setting-up-the-integration" title="Direct link to heading">​</a></h2><p>To set up the integration with Stripe through the user interface:</p><ol><li>In the side menu, select <strong>&quot;Settings&quot;</strong>;</li><li>Select the <strong>&quot;Integrations&quot;</strong> tab;</li><li>Click <strong>&quot;Stripe&quot;</strong> and enter your Stripe API key (<a href="https://support.stripe.com/questions/locate-api-keys-in-the-dashboard" target="_blank" rel="noopener noreferrer">locate your API key</a>); and</li><li>Click <strong>&quot;Connect to Stripe&quot;</strong> to confirm.</li></ol><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>By default, customers created in Lago are not automatically created in Stripe. If you want your Lago customers to be added to Stripe, you need to activate this option manually.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="customer-information">Customer information<a class="hash-link" href="#customer-information" title="Direct link to heading">​</a></h2><p>To collect payments automatically, the customer must exist in both the Lago and Stripe databases.</p><p>If the customer already exists in Stripe but not in Lago, we recommend that you use the Lago API to <a href="/docs/api/customers/create-update-customer">create the customer record</a>. When adding customer information, you must:</p><ol><li>Define Stripe as the <strong>default payment provider</strong>; and</li><li>Provide the <strong>Stripe customer ID</strong>.</li></ol><p>If the customer does not exist in Stripe, you can first create them in Lago and if the option to create Lago customers in Stripe is activated, the customer will automatically be added to Stripe. Stripe will then return the customer ID, which will be stored in Lago.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="payment-intents">Payment intents<a class="hash-link" href="#payment-intents" title="Direct link to heading">​</a></h2><p>Once Stripe is connected and the customer exists in both databases, you can start collecting payments.</p><p>Each time a new invoice <strong>with an amount greater than 0 (zero)</strong> is generated by Lago, a payment intent will automatically be created. Stripe will record the invoice ID and process the payment. If the payment is successful, the status of the invoice will switch from <code>pending</code> to <code>succeeded</code>.</p><p>If the payment fails, the status of the invoice will switch from <code>pending</code> to <code>failed</code> and Lago will generate an <code>invoice.payment_failure</code> webhook (<a href="/docs/api/webhooks/invoice-payment-failure">learn more</a>).</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>A valid payment method for the customer must be defined in Stripe for the payment intent to succeed (<a href="https://stripe.com/docs/payments/save-and-reuse" target="_blank" rel="noopener noreferrer">learn how to save payment details</a>).</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="implementation-options">Implementation options<a class="hash-link" href="#implementation-options" title="Direct link to heading">​</a></h2><p>The level of development of your billing and payment system will determine the optimal setup for the Lago-Stripe integration.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="new-billing-and-payment-system">New billing and payment system<a class="hash-link" href="#new-billing-and-payment-system" title="Direct link to heading">​</a></h3><p>When implementing a new system:</p><ol><li>Set up the Lago-Stripe integration and <strong>activate</strong> the option that automatically creates Lago customers in Stripe;</li><li>When a customer signs up to your application, use the API to create the corresponding customer record in Lago;</li><li>Lago will automatically create the customer in Stripe and retrieve the Stripe customer ID;</li><li>When the customer adds their payment details via the checkout page of your application, use the Stripe API to update their payment method; and</li><li>You&#x27;re ready to start billing!</li></ol><p><img loading="lazy" alt="Illustration of the setup when billing from scratch" src="/assets/images/from scratch-e99ec7af752438786978356ee6502792.png" width="1792" height="922" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="migration-to-a-new-billing-system">Migration to a new billing system<a class="hash-link" href="#migration-to-a-new-billing-system" title="Direct link to heading">​</a></h3><p>When migrating to a new system:</p><ol><li>Set up the Lago-Stripe integration and <strong>deactivate</strong> the option that automatically creates Lago customers in Stripe;</li><li>Use the customer information that is already in your application database to create customers in Lago, including their Stripe customer ID;</li><li>Make sure there&#x27;s a valid payment method defined for each customer in Stripe; and</li><li>You&#x27;re ready to start billing!</li></ol><p><img loading="lazy" alt="Illustration of the setup when migrating to a new billing system" src="/assets/images/migration-58e0b439c3a0936651952e70b0e9589d.png" width="1848" height="528" class="img_E7b_"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guide/testing-integration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Integration Testing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setting-up-the-integration" class="table-of-contents__link toc-highlight">Setting up the integration</a></li><li><a href="#customer-information" class="table-of-contents__link toc-highlight">Customer information</a></li><li><a href="#payment-intents" class="table-of-contents__link toc-highlight">Payment intents</a></li><li><a href="#implementation-options" class="table-of-contents__link toc-highlight">Implementation options</a><ul><li><a href="#new-billing-and-payment-system" class="table-of-contents__link toc-highlight">New billing and payment system</a></li><li><a href="#migration-to-a-new-billing-system" class="table-of-contents__link toc-highlight">Migration to a new billing system</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/guide/intro">Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api/intro">API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lago-community.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/GetLago" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://calendly.com/lago-team/20min-meeting-with-lago-team" target="_blank" rel="noopener noreferrer" class="footer__link-item">Book a demo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/getlago/lago" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 - Lago.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.395518a5.js"></script>
<script src="/assets/js/main.22c07d6a.js"></script>
</body>
</html>